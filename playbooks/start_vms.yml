---
- hosts: workstation.example.com
  become: true
  tasks:
    - name: Wait for vcenter to be available
      wait_for:
        port: 9443
        host: vcenter.example.com
        delay: 10
      vars:
        ansible_connection: local
    - name: Set powerstate on for ticket-monster vms
      vmware_guest:
        hostname: "{{ vcenter_ip }}"
        username: "{{ vcenter_username }}"
        password: "{{ vcenter_password }}"
        validate_certs: False
        name: "{{ item }}"
        state: rebootguest
      delegate_to: localhost
      with_items:
        - db
        - jboss0
        - jboss1
        - lb

